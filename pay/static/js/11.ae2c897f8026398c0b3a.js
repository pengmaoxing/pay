webpackJsonp([11],{"T5I/":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("CJJO"),n={data:function(){return{htmlProportion:"",htmlWidth:"",htmlheight:"",isWxPay:!0,yenSymbol:"¥",payMoney:"",userId:"",remarks:"",testProcess:"",testMoney:"",testRes:"暂无数据",testFail:"暂无错误信息",merchantName:"",storeId:"",buyerId:"",merchantId:"",memberOpenId:"",price:"",timeStamp:"",orderNumber:"",payLoading:!1}},created:function(){var t=this;this.htmlWidth=document.documentElement.clientWidth||document.body.clientWidth,this.htmlheight=document.documentElement.clientHeight||document.body.clientHeight,this.htmlProportion=this.htmlWidth/750,this.testProcess="开始";var e=this.$route.query.buyerId;null!=e&&""!=e&&"null"!=e&&e&&(this.openId=e);var s=this.$route.query.price;null!=s&&""!=s&&"null"!=s&&s&&(this.payMoney=s);var n=this.$route.query.userId;null!=n&&""!=n&&"null"!=n&&n&&(this.userId=n,this.testProcess=n);var i=this.$route.query.storeId;null!=i&&""!=i&&"null"!=i&&i&&(this.storeId=i);var r=this.$route.query.merchantId;null!=r&&""!=r&&"null"!=r&&r&&(this.merchantId=r),Object(a.f)(this.userId,this.merchantId).then(function(e){console.log(e),t.merchantName=e.obj}).catch(function(e){console.log(e),t.testFail=e})},watch:{payLoading:function(t,e){var s=this;1==this.payLoading&&setTimeout(function(){s.payLoading=!1},2e3)}},methods:{payment:function(){var t=this;if(1!=this.payLoading){this.payLoading=!0,this.testProcess="进行付款";/^\d+\.?\d{0,2}$/.test(this.payMoney)?0!=this.payMoney&&Object(a.g)(2,this.payMoney,this.userId,this.openId,this.storeId,"","","","",this.remarks).then(function(e){switch(t.testProcess="付款接口调取成功，进行付款跳转;"+e.obj.openWay,console.log(e),t.timeStamp=e.obj.payTime,t.orderNumber=e.obj.orderNumber,parseInt(e.obj.openWay)){case 1:t.testProcess="链接直接打开",window.location.href=e.obj.payUrl;break;case 2:t.testProcess="开始唤醒付款",t.tradePay(e.obj.tradeNo)}}).catch(function(e){console.log(e),t.testProcess="付款接口调取失败，尝试获得错误信息",t.testFail=e}):this.$message.warning("金额错误")}},inputEmpty:function(){this.payMoney=""},ready:function(t){window.AlipayJSBridge?t&&t():document.addEventListener("AlipayJSBridgeReady",t,!1)},tradePay:function(t){var e=this;this.testProcess="进行唤醒付款",this.ready(function(){AlipayJSBridge.call("tradePay",{tradeNO:t},function(t){"9000"==t.resultCode&&(e.testProcess="唤醒付款成功",e.$router.push({path:"/zfb/advertisement",query:{userId:e.userId,storeId:e.storeId,merchantId:e.merchantId,price:e.payMoney,timeStamp:e.timeStamp,orderNumber:e.orderNumber}}))})})}}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"lf-store-name",style:{height:150*t.htmlProportion+"px"}},[s("span",{staticClass:"text-lg"},[t._v(t._s(t.merchantName?t.merchantName:""))])]),t._v(" "),s("div",{staticClass:"lf-pay-panel",style:{height:300*t.htmlProportion+"px"}},[s("div",[t._m(0),t._v(" "),s("div",{staticClass:"two"},[s("span",{staticClass:"text-llg"},[t._v(t._s(t.yenSymbol)+" ")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.payMoney,expression:"payMoney"}],staticStyle:{"font-size":"2.25rem",width:"80%",border:"none"},attrs:{type:"number"},domProps:{value:t.payMoney},on:{focus:t.inputEmpty,input:function(e){e.target.composing||(t.payMoney=e.target.value)}}})]),t._v(" "),s("div",{staticClass:"three"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.remarks,expression:"remarks"}],staticClass:"text-grey",attrs:{type:"text",maxlength:"20",placeholder:"添加备注(20个字以内)"},domProps:{value:t.remarks},on:{input:function(e){e.target.composing||(t.remarks=e.target.value)}}})])])]),t._v(" "),s("div",{staticClass:"lf-pay-btn",style:{height:200*t.htmlProportion+"px"}},[s("div",{class:[{"bg-ff4500":!t.payLoading},{"bg-ad2f00":t.payLoading}],on:{click:t.payment}},[t.payLoading?s("div",{staticClass:"icon-loading"}):t._e(),t._v(" "),s("span",{staticClass:"text-lg"},[t._v("付 款")])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"one"},[e("span",{staticClass:"text-sm"},[this._v("请向收银员询问应付金额")])])}]};var r=s("C7Lr")(n,i,!1,function(t){s("mr43")},null,null);e.default=r.exports},mr43:function(t,e){}});